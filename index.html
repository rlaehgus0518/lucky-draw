<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Lucky Draw</title>
<style>
  :root{ --panel:#0f1724; --accent:#ffd166; --text:#f8fafc; --rowh:48px; }
  html,body{height:100%;margin:0;font-family:Inter,system-ui,"Apple SD Gothic Neo","Malgun Gothic",sans-serif;background:#07122a;color:var(--text);}
  .wrap{min-height:100vh;display:flex;flex-direction:column;align-items:center;gap:22px;padding:32px;box-sizing:border-box}
  .title{font-size:128px;font-weight:1000;letter-spacing:2px;color:#e8edf7;text-shadow:0 6px 26px rgba(0,0,0,.45)}
  .stage{width:100%;max-width:1200px;display:flex;justify-content:center;}
  .centerStack{display:flex;flex-direction:column;gap:18px;align-items:center}
  .panel{width:520px;max-width:90vw;border-radius:12px;background:linear-gradient(180deg,#071a2b,#052036);
    display:flex;align-items:center;justify-content:center;padding:18px 20px;box-sizing:border-box;overflow:hidden;
    box-shadow:0 10px 30px rgba(2,6,23,0.6)}
  .display{display:flex;gap:12px;align-items:center;z-index:2}
  .wheel{
    width:120px;background:linear-gradient(180deg,#0a2736,#06202c);
    border-radius:10px;display:flex;align-items:center;justify-content:center;
    overflow:hidden;position:relative;border:2px solid rgba(255,255,255,0.04)
  }
  .digit-strip{
    position:absolute;top:0;left:0;right:0;display:block;transform:translateY(0);
    will-change:transform; backface-visibility:hidden;
  }
  .digit{
    height:48px;line-height:48px;text-align:center;font-weight:800;font-size:44px;color:var(--accent);
    text-shadow:0 2px 8px rgba(0,0,0,0.6);
  }
  .wheel::before,.wheel::after{content:"";position:absolute;left:0;right:0;height:28%;pointer-events:none}
  .wheel::before{top:0;background:linear-gradient(to bottom,rgba(7,18,42,.85),rgba(7,18,42,0))}
  .wheel::after{bottom:0;background:linear-gradient(to top,rgba(7,18,42,.85),rgba(7,18,42,0))}
  .focus-frame{
    position:absolute;left:8px;right:8px;top:0;bottom:0;margin:auto;
    height:calc(var(--digitH,48px));
    border:3px solid rgba(255,209,102,.9);border-radius:10px;
    box-shadow:0 0 16px rgba(255,209,102,.25),inset 0 0 8px rgba(255,209,102,.25);
    pointer-events:none;
  }
  .actions{display:flex;gap:10px;margin-top:8px;}
  .btn{background:transparent;border:1px solid rgba(255,255,255,0.08);padding:12px 18px;border-radius:12px;color:#fff;cursor:pointer;font-weight:800}
  .btn.primary{background:var(--accent);color:#081022;border:0}
  .big-result-wrap{width:520px;max-width:90vw;background:rgba(10,20,35,.55);border:1px solid rgba(255,255,255,.06);border-radius:12px;padding:12px 16px;margin-top:12px;}
  .big-result{text-align:center;font-size:112px;font-weight:1000;color:#ffe08a;text-shadow:0 6px 24px rgba(0,0,0,.5)}
  .range-set{display:flex;gap:10px;align-items:center;margin-top:10px;font-size:18px;}
  input{width:90px;padding:6px 8px;border-radius:6px;border:none;text-align:center;font-size:16px;}
</style>
</head>
<body>
<div class="wrap">
  <div class="title">Lucky Draw</div>
  <div class="stage">
    <div class="centerStack">
      <div class="panel">
        <div class="display">
          <div class="wheel" data-pos="h"><div class="digit-strip"></div><div class="focus-frame"></div></div>
          <div class="wheel" data-pos="t"><div class="digit-strip"></div><div class="focus-frame"></div></div>
          <div class="wheel" data-pos="o"><div class="digit-strip"></div><div class="focus-frame"></div></div>
        </div>
      </div>

      <div class="range-set">
        <label>범위:</label>
        <input type="number" id="minInput" value="1" min="0">
        <span>~</span>
        <input type="number" id="maxInput" value="100" min="1">
      </div>

      <div class="actions">
        <button class="btn primary" id="drawBtn">추첨</button>
        <button class="btn" id="resetBtn">Reset</button>
      </div>

      <div class="big-result-wrap">
        <div id="bigResult" class="big-result">—</div>
      </div>
    </div>
  </div>
</div>

<script>
(() => {
  const wheels = [...document.querySelectorAll('.wheel')];
  const wheelH=wheels[0], wheelT=wheels[1], wheelO=wheels[2];
  const drawBtn=document.getElementById('drawBtn');
  const resetBtn=document.getElementById('resetBtn');
  const bigResult=document.getElementById('bigResult');
  const minInput=document.getElementById('minInput');
  const maxInput=document.getElementById('maxInput');

  const STRIP_REP=40;
  function buildStrip(wheel){
    const strip=wheel.querySelector('.digit-strip'); strip.innerHTML='';
    for(let r=0;r<STRIP_REP;r++)for(let d=0;d<10;d++){
      const el=document.createElement('div');
      el.className='digit'; el.textContent=d; strip.appendChild(el);
    }
  }
  wheels.forEach(buildStrip);
  const digitHeight=()=>Math.round(document.querySelector('.digit').getBoundingClientRect().height);
  const VISIBLE_REP=4; const TARGET_REP=20; const baseLen=10;
  function visibleBaseIndex(d){return VISIBLE_REP*baseLen+(d-1);}

  const easeOutQuint=t=>1-Math.pow(1-t,5);
  const animateToIndex=(wheel,endIndex,duration)=>new Promise(res=>{
    const strip=wheel.querySelector('.digit-strip');
    const cur=getComputedStyle(strip).transform;
    let startY=0;if(cur&&cur!=='none'){const m=cur.match(/matrix.*\((.+)\)/);if(m){const p=m[1].split(',');startY=parseFloat(p[5])||0;}}
    const endY=-endIndex*digitHeight(),start=performance.now();
    const step=now=>{
      const t=Math.min(1,(now-start)/duration),p=easeOutQuint(t);
      const y=startY+(endY-startY)*p;
      strip.style.transform=`translate3d(0,${y}px,0)`;
      if(t<1)requestAnimationFrame(step); else res();
    };
    requestAnimationFrame(step);
  });
  function setInstant(wheel,d){
    const strip=wheel.querySelector('.digit-strip');
    strip.style.transition='none';
    strip.style.transform=`translate3d(0,${-visibleBaseIndex(d)*digitHeight()}px,0)`;
  }

  async function spinToDigit(wheel,digit,extra,dur){
    const raw=(TARGET_REP+extra)*baseLen+(digit-1);
    await animateToIndex(wheel,raw,dur);
    const strip=wheel.querySelector('.digit-strip');
    strip.style.transform=`translate3d(0,${-visibleBaseIndex(digit)*digitHeight()}px,0)`;
  }

  const EXTRA_H=10,EXTRA_T=12,EXTRA_O=14,SPIN_TIME=3000;
  let spinning=false;
  async function spinTo(n){
    if(spinning)return;spinning=true;drawBtn.disabled=true;
    const h=Math.floor(n/100),t=Math.floor((n%100)/10),o=n%10;
    await Promise.all([
      spinToDigit(wheelH,n===100?1:h,EXTRA_H,SPIN_TIME),
      spinToDigit(wheelT,n===100?0:t,EXTRA_T,SPIN_TIME),
      spinToDigit(wheelO,n===100?0:o,EXTRA_O,SPIN_TIME)
    ]);
    bigResult.textContent=n;
    spinning=false;drawBtn.disabled=false;
  }

  drawBtn.onclick=()=>{
    let min=parseInt(minInput.value)||1;
    let max=parseInt(maxInput.value)||100;
    if(min>=max){max=min+1;}
    const rand=Math.floor(Math.random()*(max-min+1))+min;
    bigResult.textContent='...';
    spinTo(rand);
  };
  resetBtn.onclick=()=>{[wheelH,wheelT,wheelO].forEach(w=>setInstant(w,0));bigResult.textContent='—';};

  window.onload=()=>{[wheelH,wheelT,wheelO].forEach(w=>setInstant(w,0));};
})();
</script>
</body>
</html>
